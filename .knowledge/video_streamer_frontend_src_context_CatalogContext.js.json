{"is_source_file": true, "format": "JavaScript", "description": "This file defines a React context provider component named CatalogContext that manages a catalog of video items, including their fetching, caching, validation, and replacement logic. It handles videos from YouTube, Vimeo, and public MP4 sources, performing preflight oEmbed checks, caching results, and maintaining a stable list of 30 curated videos with backup options and ordering preservation.", "external_files": ["../data/videos", "../data/backupVideos"], "external_methods": ["localStorage.getItem", "localStorage.setItem", "localStorage.removeItem", "fetch", "setTimeout", "clearTimeout", "JSON.parse", "JSON.stringify"], "published": ["CatalogContext"], "classes": [], "methods": [{"name": "readVimeoEmbedCache(id)", "description": "Reads Vimeo oEmbed cache data from localStorage and returns cached status or null if expired or not present.", "scope": "", "scopeKind": ""}, {"name": "writeVimeoEmbedCache(id, ok)", "description": "Writes Vimeo oEmbed cache data with a TTL based on success ('u' for unknown) to localStorage.", "scope": "", "scopeKind": ""}, {"name": "preflightVimeoOEmbed(id, externalSignal)", "description": "Performs a preflight check for Vimeo oEmbed availability with a network timeout and caches the result.", "scope": "", "scopeKind": ""}, {"name": "normalizeItem(v, idx)", "description": "Normalizes raw YouTube video data into a standard catalog item format.", "scope": "", "scopeKind": ""}, {"name": "normalizeVimeoItem(v, idx)", "description": "Normalizes raw Vimeo video data into a standard catalog item format.", "scope": "", "scopeKind": ""}, {"name": "normalizeMp4Item(v, idx)", "description": "Normalizes raw MP4 public clip data into a standard catalog item format.", "scope": "", "scopeKind": ""}, {"name": "readJSON(key)", "description": "Safely reads and parses JSON data from localStorage.", "scope": "", "scopeKind": ""}, {"name": "writeJSON(key, value)", "description": "Safely serializes and writes JSON data to localStorage.", "scope": "", "scopeKind": ""}, {"name": "readEmbedCache(id)", "description": "Reads cached oEmbed result for a given video ID, supporting versioned storage and fallback.", "scope": "", "scopeKind": ""}, {"name": "writeEmbedCache(id, ok)", "description": "Writes oEmbed cache data with a TTL depending on success or unknown status.", "scope": "", "scopeKind": ""}, {"name": "preflightOEmbed(id, externalSignal)", "description": "Performs a preflight check for YouTube oEmbed availability with a network timeout and caches the result.", "scope": "", "scopeKind": ""}, {"name": "readSavedCatalog()", "description": "Retrieves the last saved catalog data if valid and not expired.", "scope": "", "scopeKind": ""}, {"name": "readSavedTop7()", "description": "Retrieves the last saved top-7 ordering for the catalog.", "scope": "", "scopeKind": ""}, {"name": "persistCatalog(items)", "description": "Persists the current list of 30 videos into localStorage with a versioned key and saves top-7 ordering.", "scope": "", "scopeKind": ""}, {"name": "buildFinal", "description": "Builds and finalizes the complete 30-item catalog, including preflight checks, applying backup sources, and maintaining top-7 order."}, {"name": "verifyAndRepair", "description": "Verifies the current catalog and repairs items with failed oEmbed checks by replacing them from backup or primary pools."}, {"name": "replaceWithBackup", "description": "Replaces an item in the catalog with a backup/original item, updating the state and top-7 list as needed."}, {"name": "refreshCatalog", "description": "Triggers a full rebuild of the catalog, clearing saved final list and reinitializing data."}, {"name": "CatalogProvider({ children })", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "dlog(...args)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "findReplacement()", "scope": "CatalogProvider", "scopeKind": "function", "description": "unavailable"}], "calls": ["localStorage.getItem", "localStorage.setItem", "localStorage.removeItem", "fetch", "setTimeout", "clearTimeout", "JSON.parse", "JSON.stringify", "preflightOEmbed", "preflightVimeoOEmbed"], "search-terms": ["CatalogContext", "video_streamer_frontend", "oEmbed preflight", "Vimeo cache", "YouTube oEmbed", "cache warming", "backupVideos", "top-7 ordering", "React context", "video catalog management"], "state": 2, "file_id": 24, "knowledge_revision": 150, "git_revision": "f728d5ef1f800379fbf39fcc9332ab4b438b93b6", "revision_history": [{"119": ""}, {"128": "d42cd53beb8901b440762ea89a84cfda363f4028"}, {"138": "cc76299156655c4771285f27c036d5c6dc6fc5f3"}, {"144": "f728d5ef1f800379fbf39fcc9332ab4b438b93b6"}, {"145": "f728d5ef1f800379fbf39fcc9332ab4b438b93b6"}, {"146": "f728d5ef1f800379fbf39fcc9332ab4b438b93b6"}, {"147": "f728d5ef1f800379fbf39fcc9332ab4b438b93b6"}, {"148": "f728d5ef1f800379fbf39fcc9332ab4b438b93b6"}, {"149": "f728d5ef1f800379fbf39fcc9332ab4b438b93b6"}, {"150": "f728d5ef1f800379fbf39fcc9332ab4b438b93b6"}], "ctags": [{"_type": "tag", "name": "CatalogContext", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^export const CatalogContext = createContext({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "CatalogProvider", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^export function CatalogProvider({ children }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ children })"}, {"_type": "tag", "name": "DEBUG", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^const DEBUG =$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "KEYS", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^const KEYS = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "STORAGE_VERSION", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^const STORAGE_VERSION = 'v2';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "catalogFinalV1", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogFinalV1: 'sv:catalog:final', \\/\\/ legacy (read-only fallback)$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "catalogFinalV2", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogFinalV2: `sv:catalog:final:${STORAGE_VERSION}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "catalogTop7V1", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogTop7V1: 'sv:catalog:top7',   \\/\\/ legacy (read-only fallback)$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "catalogTop7V2", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogTop7V2: `sv:catalog:top7:${STORAGE_VERSION}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "dlog", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function dlog(...args) {$/", "language": "JavaScript", "kind": "function", "signature": "(...args)"}, {"_type": "tag", "name": "findReplacement", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^    async function findReplacement() {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "CatalogProvider", "scopeKind": "function"}, {"_type": "tag", "name": "normalizeItem", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function normalizeItem(v, idx) {$/", "language": "JavaScript", "kind": "function", "signature": "(v, idx)"}, {"_type": "tag", "name": "normalizeMp4Item", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function normalizeMp4Item(v, idx) {$/", "language": "JavaScript", "kind": "function", "signature": "(v, idx)"}, {"_type": "tag", "name": "normalizeVimeoItem", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function normalizeVimeoItem(v, idx) {$/", "language": "JavaScript", "kind": "function", "signature": "(v, idx)"}, {"_type": "tag", "name": "oembedV1", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  oembedV1: (id) => `sv:oembed:${id}`, \\/\\/ legacy (read-only fallback)$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "oembedV2", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  oembedV2: (id) => `sv:oembed:${id}:${STORAGE_VERSION}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "persistCatalog", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function persistCatalog(items) {$/", "language": "JavaScript", "kind": "function", "signature": "(items)"}, {"_type": "tag", "name": "preflightOEmbed", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^async function preflightOEmbed(id, externalSignal) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, externalSignal)"}, {"_type": "tag", "name": "preflightVimeoOEmbed", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^async function preflightVimeoOEmbed(id, externalSignal) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, externalSignal)"}, {"_type": "tag", "name": "readEmbedCache", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readEmbedCache(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "readJSON", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readJSON(key) {$/", "language": "JavaScript", "kind": "function", "signature": "(key)"}, {"_type": "tag", "name": "readSavedCatalog", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readSavedCatalog() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "readSavedTop7", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readSavedTop7() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "readVimeoEmbedCache", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readVimeoEmbedCache(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "thumbFail", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  thumbFail: (id) => `sv:thumbfail:${id}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  return <CatalogContext.Provider value={value}>{children}<\\/CatalogContext.Provider>;$/", "language": "JavaScript", "kind": "field", "scope": "Provider", "scopeKind": "class"}, {"_type": "tag", "name": "vimeoOEmbedV2", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  vimeoOEmbedV2: (id) => `sv:oembed:vimeo:${id}:${STORAGE_VERSION}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "writeEmbedCache", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function writeEmbedCache(id, ok) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, ok)"}, {"_type": "tag", "name": "writeJSON", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function writeJSON(key, value) {$/", "language": "JavaScript", "kind": "function", "signature": "(key, value)"}, {"_type": "tag", "name": "writeVimeoEmbedCache", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function writeVimeoEmbedCache(id, ok) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, ok)"}], "hash": "6c599e1922fcea40d9d3c8be34e294f6", "format-version": 4, "code-base-name": "video_streamer_frontend", "filename": "video_streamer_frontend/src/context/CatalogContext.js", "fields": [{"name": "catalogFinalV1: 'sv:catalog:final', \\/\\/ legacy (read-only fallback)", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "catalogFinalV2: `sv:catalog:final:${STORAGE_VERSION}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "catalogTop7V1: 'sv:catalog:top7',   \\/\\/ legacy (read-only fallback)", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "catalogTop7V2: `sv:catalog:top7:${STORAGE_VERSION}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "oembedV1: (id) => `sv:oembed:${id}`, \\/\\/ legacy (read-only fallback)", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "oembedV2: (id) => `sv:oembed:${id}:${STORAGE_VERSION}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "thumbFail: (id) => `sv:thumbfail:${id}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "return <CatalogContext.Provider value={value}>{children}<\\/CatalogContext.Provider>;", "scope": "Provider", "scopeKind": "class", "description": "unavailable"}, {"name": "vimeoOEmbedV2: (id) => `sv:oembed:vimeo:${id}:${STORAGE_VERSION}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}]}