{"is_source_file": true, "format": "JavaScript", "description": "This file defines a React context provider component CatalogProvider that manages a catalog of YouTube videos and MP4 clips for a frontend application. It includes data normalization, caching, preflight checks for embedability, catalog persistence, and methods for updating the catalog, such as replacing videos with backup options. It also provides an API via React Context for consuming components.", "external_files": ["../data/videos", "../data/backupVideos"], "external_methods": ["fetch"], "published": ["CatalogContext"], "classes": [], "methods": [{"name": "normalizeItem(v, idx)", "description": "Normalizes raw YouTube video data into a standardized catalog item format.", "scope": "", "scopeKind": ""}, {"name": "normalizeMp4Item(v, idx)", "description": "Normalizes raw MP4 video data into a standardized catalog item format.", "scope": "", "scopeKind": ""}, {"name": "readJSON(key)", "description": "Reads and parses JSON data from local storage for a given key.", "scope": "", "scopeKind": ""}, {"name": "writeJSON(key, value)", "description": "Serializes and writes data to local storage under a specified key.", "scope": "", "scopeKind": ""}, {"name": "readEmbedCache(id)", "description": "Retrieves and interprets oEmbed cache status for a given YouTube video ID.", "scope": "", "scopeKind": ""}, {"name": "writeEmbedCache(id, ok)", "description": "Stores oEmbed check result and expiry timestamp in local storage.", "scope": "", "scopeKind": ""}, {"name": "preflightOEmbed(id, externalSignal)", "description": "Performs an async oEmbed preflight check with timeout, returning cache status or network result.", "scope": "", "scopeKind": ""}, {"name": "readSavedCatalog()", "description": "Retrieves the last saved catalog from local storage if still valid.", "scope": "", "scopeKind": ""}, {"name": "readSavedTop7()", "description": "Retrieves the saved top-7 ordering from local storage.", "scope": "", "scopeKind": ""}, {"name": "persistCatalog(items)", "description": "Persists a complete catalog list and top-7 order into local storage.", "scope": "", "scopeKind": ""}, {"name": "CatalogProvider({ children })", "description": "Main React component that manages catalog state, including building, verification, replacement, and persistence logic.", "scope": "", "scopeKind": ""}, {"name": "replaceWithBackup", "description": "Replaces a specified video with a backup candidate, updating catalog state accordingly."}, {"name": "refreshCatalog", "description": "Clears persisted catalog data and triggers a rebuild of the catalog."}, {"name": "dlog(...args)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "findReplacement()", "scope": "CatalogProvider", "scopeKind": "function", "description": "unavailable"}], "calls": ["fetch", "setTimeout", "clearTimeout", "localStorage.getItem", "localStorage.setItem", "localStorage.removeItem", "JSON.parse", "JSON.stringify", "console.log"], "search-terms": ["CatalogContext", "Videos normalization", "oEmbed preflight", "retry logic", "backupVideos data", "cache management", "React Context", "Video catalog", "async replacement", "persistent storage"], "state": 2, "file_id": 24, "knowledge_revision": 138, "git_revision": "cc76299156655c4771285f27c036d5c6dc6fc5f3", "revision_history": [{"119": ""}, {"128": "d42cd53beb8901b440762ea89a84cfda363f4028"}, {"138": "cc76299156655c4771285f27c036d5c6dc6fc5f3"}], "ctags": [{"_type": "tag", "name": "CatalogContext", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^export const CatalogContext = createContext({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "CatalogProvider", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^export function CatalogProvider({ children }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ children })"}, {"_type": "tag", "name": "DEBUG", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^const DEBUG =$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "KEYS", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^const KEYS = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "STORAGE_VERSION", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^const STORAGE_VERSION = 'v2';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "catalogFinalV1", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogFinalV1: 'sv:catalog:final', \\/\\/ legacy (read-only fallback)$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "catalogFinalV2", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogFinalV2: `sv:catalog:final:${STORAGE_VERSION}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "catalogTop7V1", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogTop7V1: 'sv:catalog:top7',   \\/\\/ legacy (read-only fallback)$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "catalogTop7V2", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogTop7V2: `sv:catalog:top7:${STORAGE_VERSION}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "dlog", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function dlog(...args) {$/", "language": "JavaScript", "kind": "function", "signature": "(...args)"}, {"_type": "tag", "name": "findReplacement", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^    async function findReplacement() {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "CatalogProvider", "scopeKind": "function"}, {"_type": "tag", "name": "normalizeItem", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function normalizeItem(v, idx) {$/", "language": "JavaScript", "kind": "function", "signature": "(v, idx)"}, {"_type": "tag", "name": "normalizeMp4Item", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function normalizeMp4Item(v, idx) {$/", "language": "JavaScript", "kind": "function", "signature": "(v, idx)"}, {"_type": "tag", "name": "oembedV1", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  oembedV1: (id) => `sv:oembed:${id}`, \\/\\/ legacy (read-only fallback)$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "oembedV2", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  oembedV2: (id) => `sv:oembed:${id}:${STORAGE_VERSION}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "persistCatalog", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function persistCatalog(items) {$/", "language": "JavaScript", "kind": "function", "signature": "(items)"}, {"_type": "tag", "name": "preflightOEmbed", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^async function preflightOEmbed(id, externalSignal) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, externalSignal)"}, {"_type": "tag", "name": "readEmbedCache", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readEmbedCache(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "readJSON", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readJSON(key) {$/", "language": "JavaScript", "kind": "function", "signature": "(key)"}, {"_type": "tag", "name": "readSavedCatalog", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readSavedCatalog() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "readSavedTop7", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readSavedTop7() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "thumbFail", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  thumbFail: (id) => `sv:thumbfail:${id}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  return <CatalogContext.Provider value={value}>{children}<\\/CatalogContext.Provider>;$/", "language": "JavaScript", "kind": "field", "scope": "Provider", "scopeKind": "class"}, {"_type": "tag", "name": "writeEmbedCache", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function writeEmbedCache(id, ok) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, ok)"}, {"_type": "tag", "name": "writeJSON", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function writeJSON(key, value) {$/", "language": "JavaScript", "kind": "function", "signature": "(key, value)"}], "hash": "41644c35710c0133c00b125282f7c16b", "format-version": 4, "code-base-name": "video_streamer_frontend", "filename": "video_streamer_frontend/src/context/CatalogContext.js", "fields": [{"name": "catalogFinalV1: 'sv:catalog:final', \\/\\/ legacy (read-only fallback)", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "catalogFinalV2: `sv:catalog:final:${STORAGE_VERSION}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "catalogTop7V1: 'sv:catalog:top7',   \\/\\/ legacy (read-only fallback)", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "catalogTop7V2: `sv:catalog:top7:${STORAGE_VERSION}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "oembedV1: (id) => `sv:oembed:${id}`, \\/\\/ legacy (read-only fallback)", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "oembedV2: (id) => `sv:oembed:${id}:${STORAGE_VERSION}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "thumbFail: (id) => `sv:thumbfail:${id}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "return <CatalogContext.Provider value={value}>{children}<\\/CatalogContext.Provider>;", "scope": "Provider", "scopeKind": "class", "description": "unavailable"}]}