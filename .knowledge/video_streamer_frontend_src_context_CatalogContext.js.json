{"is_source_file": true, "format": "JavaScript", "description": "This source file defines a React context and provider component for managing a resilient catalog of YouTube videos, including data normalization, caching, preflight checks, and catalog management logic.", "external_files": ["../data/videos", "../data/backupVideos"], "external_methods": ["fetch"], "published": ["CatalogContext"], "classes": [], "methods": [{"name": "normalizeItem(v, idx)", "description": "Normalizes a raw video dataset item into a consistent catalog item format.", "scope": "", "scopeKind": ""}, {"name": "readJSON(key)", "description": "Reads and parses JSON data from localStorage by key.", "scope": "", "scopeKind": ""}, {"name": "writeJSON(key, value)", "description": "Stringifies and saves JSON data to localStorage under a specified key.", "scope": "", "scopeKind": ""}, {"name": "readEmbedCache(id)", "description": "Reads the cached oEmbed check result for a video ID, considering TTL and fallback versions.", "scope": "", "scopeKind": ""}, {"name": "writeEmbedCache(id, ok)", "description": "Writes oEmbed check result cache for a video ID with TTL based on success, failure, or unknown.", "scope": "", "scopeKind": ""}, {"name": "preflightOEmbed(id, externalSignal)", "description": "Performs a YouTube oEmbed preflight request with timeout, returns embedability status.", "scope": "", "scopeKind": ""}, {"name": "readSavedCatalog()", "description": "Retrieves the last saved catalog from localStorage, considering expiration.", "scope": "", "scopeKind": ""}, {"name": "readSavedTop7()", "description": "Retrieves the saved top-7 ordering list from localStorage.", "scope": "", "scopeKind": ""}, {"name": "persistCatalog(items)", "description": "Saves the current catalog of 30 items into localStorage with expiration and top-7 order.", "scope": "", "scopeKind": ""}, {"name": "CatalogProvider({ children })", "description": "React Context provider component that manages the catalog state, including build, verify, repair, and replacement logic.", "scope": "", "scopeKind": ""}, {"name": "replaceWithBackup", "description": "Replaces a specific video in the catalog with a backup candidate, updating state and persistent storage."}, {"name": "refreshCatalog", "description": "Triggers a rebuild of the catalog from scratch, clearing saved data."}, {"name": "dlog(...args)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "findReplacement()", "scope": "CatalogProvider", "scopeKind": "function", "description": "unavailable"}], "calls": ["fetch", "localStorage.getItem", "localStorage.setItem", "localStorage.removeItem", "setTimeout", "clearTimeout", "console.log"], "search-terms": ["CatalogContext", "oEmbed preflight", "video catalog resilience", "backup pool", "YouTube videos", "React context provider", "localStorage caching", "top-7 ordering", "replace with backup", "preflight check"], "state": 2, "file_id": 24, "knowledge_revision": 128, "git_revision": "d42cd53beb8901b440762ea89a84cfda363f4028", "revision_history": [{"119": ""}, {"128": "d42cd53beb8901b440762ea89a84cfda363f4028"}], "ctags": [{"_type": "tag", "name": "CatalogContext", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^export const CatalogContext = createContext({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "CatalogProvider", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^export function CatalogProvider({ children }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ children })"}, {"_type": "tag", "name": "DEBUG", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^const DEBUG =$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "KEYS", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^const KEYS = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "STORAGE_VERSION", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^const STORAGE_VERSION = 'v2';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "catalogFinalV1", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogFinalV1: 'sv:catalog:final', \\/\\/ legacy (read-only fallback)$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "catalogFinalV2", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogFinalV2: `sv:catalog:final:${STORAGE_VERSION}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "catalogTop7V1", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogTop7V1: 'sv:catalog:top7',   \\/\\/ legacy (read-only fallback)$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "catalogTop7V2", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  catalogTop7V2: `sv:catalog:top7:${STORAGE_VERSION}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "dlog", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function dlog(...args) {$/", "language": "JavaScript", "kind": "function", "signature": "(...args)"}, {"_type": "tag", "name": "findReplacement", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^    async function findReplacement() {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "CatalogProvider", "scopeKind": "function"}, {"_type": "tag", "name": "normalizeItem", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function normalizeItem(v, idx) {$/", "language": "JavaScript", "kind": "function", "signature": "(v, idx)"}, {"_type": "tag", "name": "oembedV1", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  oembedV1: (id) => `sv:oembed:${id}`, \\/\\/ legacy (read-only fallback)$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "oembedV2", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  oembedV2: (id) => `sv:oembed:${id}:${STORAGE_VERSION}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "persistCatalog", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function persistCatalog(items) {$/", "language": "JavaScript", "kind": "function", "signature": "(items)"}, {"_type": "tag", "name": "preflightOEmbed", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^async function preflightOEmbed(id, externalSignal) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, externalSignal)"}, {"_type": "tag", "name": "readEmbedCache", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readEmbedCache(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "readJSON", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readJSON(key) {$/", "language": "JavaScript", "kind": "function", "signature": "(key)"}, {"_type": "tag", "name": "readSavedCatalog", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readSavedCatalog() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "readSavedTop7", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function readSavedTop7() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "thumbFail", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  thumbFail: (id) => `sv:thumbfail:${id}`,$/", "language": "JavaScript", "kind": "property", "scope": "KEYS", "scopeKind": "class"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^  return <CatalogContext.Provider value={value}>{children}<\\/CatalogContext.Provider>;$/", "language": "JavaScript", "kind": "field", "scope": "Provider", "scopeKind": "class"}, {"_type": "tag", "name": "writeEmbedCache", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function writeEmbedCache(id, ok) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, ok)"}, {"_type": "tag", "name": "writeJSON", "path": "/home/kavia/workspace/code-generation/streamview-221852-221861/video_streamer_frontend/src/context/CatalogContext.js", "pattern": "/^function writeJSON(key, value) {$/", "language": "JavaScript", "kind": "function", "signature": "(key, value)"}], "hash": "9cd0c9f29bfbc2ead4fc107a6a129d6e", "format-version": 4, "code-base-name": "video_streamer_frontend", "filename": "video_streamer_frontend/src/context/CatalogContext.js", "fields": [{"name": "catalogFinalV1: 'sv:catalog:final', \\/\\/ legacy (read-only fallback)", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "catalogFinalV2: `sv:catalog:final:${STORAGE_VERSION}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "catalogTop7V1: 'sv:catalog:top7',   \\/\\/ legacy (read-only fallback)", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "catalogTop7V2: `sv:catalog:top7:${STORAGE_VERSION}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "oembedV1: (id) => `sv:oembed:${id}`, \\/\\/ legacy (read-only fallback)", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "oembedV2: (id) => `sv:oembed:${id}:${STORAGE_VERSION}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "thumbFail: (id) => `sv:thumbfail:${id}`,", "scope": "KEYS", "scopeKind": "class", "description": "unavailable"}, {"name": "return <CatalogContext.Provider value={value}>{children}<\\/CatalogContext.Provider>;", "scope": "Provider", "scopeKind": "class", "description": "unavailable"}]}